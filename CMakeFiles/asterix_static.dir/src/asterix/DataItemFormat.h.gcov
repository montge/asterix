        -:    0:Source:/home/e/Development/asterix/src/asterix/DataItemFormat.h
        -:    0:Graph:UAPItem.cpp.gcno
        -:    0:Data:UAPItem.cpp.gcda
        -:    0:Runs:6
        -:    1:/*
        -:    2: *  Copyright (c) 2013 Croatia Control Ltd. (www.crocontrol.hr)
        -:    3: *
        -:    4: *  This file is part of Asterix.
        -:    5: *
        -:    6: *  Asterix is free software: you can redistribute it and/or modify
        -:    7: *  it under the terms of the GNU General Public License as published by
        -:    8: *  the Free Software Foundation, either version 3 of the License, or
        -:    9: *  (at your option) any later version.
        -:   10: *
        -:   11: *  Asterix is distributed in the hope that it will be useful,
        -:   12: *  but WITHOUT ANY WARRANTY; without even the implied warranty of
        -:   13: *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        -:   14: *  GNU General Public License for more details.
        -:   15: *
        -:   16: *  You should have received a copy of the GNU General Public License
        -:   17: *  along with Asterix.  If not, see <http://www.gnu.org/licenses/>.
        -:   18: *
        -:   19: *
        -:   20: * AUTHORS: Damir Salantic, Croatia Control Ltd.
        -:   21: *
        -:   22: */
        -:   23:
        -:   24:#ifndef DATAITEMFORMAT_H_
        -:   25:#define DATAITEMFORMAT_H_
        -:   26:
        -:   27:#if defined(PYTHON_WRAPPER)
        -:   28:#include <Python.h>
        -:   29:#endif
        -:   30:
        -:   31:#include <string>
        -:   32:#include <list>
        -:   33:#include "Utils.h"
        -:   34:
        -:   35:#if defined(WIRESHARK_WRAPPER) || defined(ETHEREAL_WRAPPER)
        -:   36:#include "WiresharkWrapper.h"
        -:   37:#endif
        -:   38:
        -:   39:class DataItemBits;
        -:   40:
        -:   41:class DataItemFormat {
        -:   42:public:
        -:   43:    DataItemFormat(int id = 0);
        -:   44:
        -:   45:    virtual
        -:   46:    ~DataItemFormat();
        -:   47:
        -:   48:    std::list<DataItemFormat *> m_lSubItems; //!< List of subitem formats in this item
        -:   49:
        -:   50:    DataItemFormat *m_pParentFormat; //! Pointer to parent format (used only in XML parsing)
        -:   51:    int m_nID; //! ID of the item
        -:   52:
        -:   53:#if defined(WIRESHARK_WRAPPER) || defined(ETHEREAL_WRAPPER)
        -:   54:    static int m_nLastPID; //!< static used for allocation of m_nPID
        -:   55:#endif
        -:   56:
        -:   57:    virtual DataItemFormat *clone() const = 0; // Copy constructor
        -:   58:    virtual long getLength(const unsigned char *pData) = 0;
        -:   59:
        -:   60:    virtual bool
        -:   61:    getText(std::string &strResult, std::string &strHeader, const unsigned int formatType, unsigned char *pData,
        -:   62:            long nLength) = 0; // appends value to strResult
        -:   63:    virtual std::string printDescriptors(std::string header) = 0; // print items format descriptors
        -:   64:    virtual bool filterOutItem(const char *name) = 0; // mark item for filtering
        -:   65:    virtual bool isFiltered(const char *name) = 0; // is item filtered
        -:   66:    virtual const char *getDescription(const char *field, const char *value) = 0; // return descrtption ef element
        -:   67:
    #####:   68:    virtual bool isFixed() { return false; }; // true if this is Fixed format
    #####:   69:    virtual bool isRepetitive() { return false; }; // true if this is Repetitive format
    #####:   70:    virtual bool isBDS() { return false; }; // true if this is BDS format
    #####:   71:    virtual bool isVariable() { return false; }; // true if this is Variable format
    #####:   72:    virtual bool isExplicit() { return false; }; // true if this is Explicit format
    #####:   73:    virtual bool isCompound() { return false; }; // true if this is Compound format
    #####:   74:    virtual bool isBits() { return false; }; // true if this is Bits description format
        -:   75:
        -:   76:
        -:   77:#if defined(WIRESHARK_WRAPPER) || defined(ETHEREAL_WRAPPER)
        -:   78:    virtual fulliautomatix_definitions* getWiresharkDefinitions() = 0;
        -:   79:    virtual fulliautomatix_data* getData(unsigned char* pData, long len, int byteoffset) = 0;
        -:   80:    int getPID() { return m_nPID; }
        -:   81:
        -:   82:  private:
        -:   83:    int m_nPID; //!< Unique identifier of this format description
        -:   84:#endif
        -:   85:
        -:   86:#if defined(PYTHON_WRAPPER)
        -:   87:    virtual PyObject* getObject(unsigned char* pData, long nLength, int description) = 0;
        -:   88:    virtual void insertToDict(PyObject* p, unsigned char* pData, long nLength, int description) = 0;
        -:   89:#endif
        -:   90:
        -:   91:};
        -:   92:
        -:   93:#endif /* DATAITEMFORMAT_H_ */
