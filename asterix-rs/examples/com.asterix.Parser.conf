<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- ASTERIX Parser D-Bus Policy Configuration

       Installation:
         sudo cp com.asterix.Parser.conf /etc/dbus-1/system.d/
         sudo systemctl reload dbus

       This policy allows:
       - The 'asterix' user to own the service name
       - Any user to call methods on the service
       - Any user to receive signals from the service
  -->

  <!-- Allow asterix user to own the service name -->
  <policy user="asterix">
    <allow own="com.asterix.Parser"/>
    <allow send_destination="com.asterix.Parser"/>
    <allow receive_sender="com.asterix.Parser"/>
  </policy>

  <!-- Allow root to own the service (for testing) -->
  <policy user="root">
    <allow own="com.asterix.Parser"/>
    <allow send_destination="com.asterix.Parser"/>
    <allow receive_sender="com.asterix.Parser"/>
  </policy>

  <!-- Allow any user to call methods and receive signals -->
  <policy context="default">
    <allow send_destination="com.asterix.Parser"/>
    <allow receive_sender="com.asterix.Parser"/>
  </policy>
</busconfig>
